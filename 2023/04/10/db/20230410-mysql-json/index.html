<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"forgives.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="MySQL JSON 官方文档阅读笔记与总结，以5.7版本为主，也会介绍8.0版本的一些需要注意的变化。虽然个人还是建议用8.0+版本，但是实际工作还是5.7为主。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL JSON 总结">
<meta property="og:url" content="https://forgives.github.io/2023/04/10/db/20230410-mysql-json/index.html">
<meta property="og:site_name" content="Hello World">
<meta property="og:description" content="MySQL JSON 官方文档阅读笔记与总结，以5.7版本为主，也会介绍8.0版本的一些需要注意的变化。虽然个人还是建议用8.0+版本，但是实际工作还是5.7为主。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-04-10T08:30:00.000Z">
<meta property="article:modified_time" content="2023-05-31T12:11:33.216Z">
<meta property="article:author" content="lianhui.klh">
<meta property="article:tag" content="database">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://forgives.github.io/2023/04/10/db/20230410-mysql-json/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL JSON 总结 | Hello World</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hello World</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">吞风吻雨葬落日 欺山赶海踏雪径</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-工具">

    <a href="/htm" rel="section"><i class="fa fa-fw fa-heartbeat"></i>工具</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://forgives.github.io/2023/04/10/db/20230410-mysql-json/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://cbu01.alicdn.com/cms/upload/2016/600/239/2932006_509044107.jpg">
      <meta itemprop="name" content="lianhui.klh">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hello World">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL JSON 总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-04-10 16:30:00" itemprop="dateCreated datePublished" datetime="2023-04-10T16:30:00+08:00">2023-04-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-31 20:11:33" itemprop="dateModified" datetime="2023-05-31T20:11:33+08:00">2023-05-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>MySQL JSON 官方文档阅读笔记与总结，以5.7版本为主，也会介绍8.0版本的一些需要注意的变化。<br>虽然个人还是建议用8.0+版本，但是实际工作还是5.7为主。</p>
<span id="more"></span>

<h2 id="JSON-Data-Type"><a href="#JSON-Data-Type" class="headerlink" title="JSON Data Type"></a>JSON Data Type</h2><p>mysql 在 <code>5.7.8</code> 版本支持了<a target="_blank" rel="noopener" href="https://www.rfc-editor.org/rfc/rfc7159">RFC 7159</a> 定义的 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json.html">JSON原生数据类型</a> 。<br>JSON 数据类型相比于 String 类型增加了以下特性：</p>
<ul>
<li>自动校验JSON格式，非法格式会报错。</li>
<li>优化JSON存储，内部存储格式允许快速读取JSON中的键值，不需要读取整个JSON串。</li>
</ul>
<p>存储的JSON大小受到 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_max_allowed_packet">max_allowed_packet</a> 系统变量影响(<strong>5.7默认 4M ，8.0默认 64M</strong>)。<br><strong>8.0.13版本之前</strong> JSON类型的列不能有非NULL的默认值(默认值必须是NULL)。JSON类型属于二进制类型，所以不能直接为列建立索引，但是可以<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/create-table-secondary-indexes.html#json-column-indirect-index">在JSON列中抽取的值上建立索引</a>。</p>
<p>JSON类型的描述和String类型一样书写: <code>&#39;[&quot;a&quot;, &quot;b&quot;, 1]&#39;</code> ,使用的是 <code>utf8mb4</code> 字符集。JSON类型的值可以被赋予至变量中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = JSON_OBJECT(<span class="string">&#x27;key&#x27;</span>, <span class="string">&#x27;value&#x27;</span>);</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT @j;</span></span><br><span class="line">+------------------+</span><br><span class="line">| @j               |</span><br><span class="line">+------------------+</span><br><span class="line">| &#123;&quot;key&quot;: &quot;value&quot;&#125; |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure>
<p>不能直接赋予String类型的JSON串，需要通过JSON_OBJECT函数转换成JSON类型。JSON类型在是大小写敏感的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY(<span class="string">&#x27;x&#x27;</span>) = JSON_ARRAY(<span class="string">&#x27;X&#x27;</span>);</span></span><br><span class="line">+-----------------------------------+</span><br><span class="line">| JSON_ARRAY(&#x27;x&#x27;) = JSON_ARRAY(&#x27;X&#x27;) |</span><br><span class="line">+-----------------------------------+</span><br><span class="line">|                                 0 |</span><br><span class="line">+-----------------------------------+</span><br></pre></td></tr></table></figure>
<p><code>null,true,false</code> 这些字面量都<strong>必须是小写的</strong> （和普通字面量不一样，比如MySQL中 null，Null，NULL都代表null）：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_VALID(<span class="string">&#x27;null&#x27;</span>), JSON_VALID(<span class="string">&#x27;Null&#x27;</span>), JSON_VALID(<span class="string">&#x27;NULL&#x27;</span>);</span></span><br><span class="line">+--------------------+--------------------+--------------------+</span><br><span class="line">| JSON_VALID(&#x27;null&#x27;) | JSON_VALID(&#x27;Null&#x27;) | JSON_VALID(&#x27;NULL&#x27;) |</span><br><span class="line">+--------------------+--------------------+--------------------+</span><br><span class="line">|                  1 |                  0 |                  0 |</span><br><span class="line">+--------------------+--------------------+--------------------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT CAST(<span class="string">&#x27;null&#x27;</span> AS JSON);</span></span><br><span class="line">+----------------------+</span><br><span class="line">| CAST(&#x27;null&#x27; AS JSON) |</span><br><span class="line">+----------------------+</span><br><span class="line">| null                 |</span><br><span class="line">+----------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT CAST(<span class="string">&#x27;NULL&#x27;</span> AS JSON);</span></span><br><span class="line">ERROR 3141 (22032): Invalid JSON text in argument 1 to function cast_as_json:</span><br><span class="line">&quot;Invalid value.&quot; at position 0 in &#x27;NULL&#x27;.</span><br></pre></td></tr></table></figure>

<h2 id="JSON-Functions"><a href="#JSON-Functions" class="headerlink" title="JSON Functions"></a>JSON Functions</h2><p>介绍一些常用的JSON相关的函数。分为5大类</p>
<ol>
<li>创建JSON函数</li>
<li>搜索JSON函数</li>
<li>修改JSON函数</li>
<li>JSON属性函数</li>
<li>JSON工具函数</li>
</ol>
<h3 id="创建JSON函数"><a href="#创建JSON函数" class="headerlink" title="创建JSON函数"></a>创建JSON函数</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json-creation-functions.html">Functions That Create JSON Values</a></p>
<h4 id="JSON-ARRAY-val-val-…"><a href="#JSON-ARRAY-val-val-…" class="headerlink" title="JSON_ARRAY([val[, val] …])"></a>JSON_ARRAY([val[, val] …])</h4><p>参数为多个值(类型可以不同)，创建JSON array</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY(1, <span class="string">&quot;abc&quot;</span>, NULL, TRUE, CURTIME());</span></span><br><span class="line">+---------------------------------------------+</span><br><span class="line">| JSON_ARRAY(1, &quot;abc&quot;, NULL, TRUE, CURTIME()) |</span><br><span class="line">+---------------------------------------------+</span><br><span class="line">| [1, &quot;abc&quot;, null, true, &quot;11:30:24.000000&quot;]   |</span><br><span class="line">+---------------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-OBJECT-key-val-key-val-…"><a href="#JSON-OBJECT-key-val-key-val-…" class="headerlink" title="JSON_OBJECT([key, val[, key, val] …])"></a>JSON_OBJECT([key, val[, key, val] …])</h4><p>参数为多组key&#x2F;value对，创建JSON object</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_OBJECT(<span class="string">&#x27;id&#x27;</span>, 87, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;carrot&#x27;</span>);</span></span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| JSON_OBJECT(&#x27;id&#x27;, 87, &#x27;name&#x27;, &#x27;carrot&#x27;) |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| &#123;&quot;id&quot;: 87, &quot;name&quot;: &quot;carrot&quot;&#125;            |</span><br><span class="line">+-----------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-QUOTE-string"><a href="#JSON-QUOTE-string" class="headerlink" title="JSON_QUOTE(string)"></a>JSON_QUOTE(string)</h4><p>参数是String类型，返回通过双引号包裹形成json value值，通常用来创建JSON中的String类型的值。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_QUOTE(<span class="string">&#x27;null&#x27;</span>), JSON_QUOTE(<span class="string">&#x27;&quot;null&quot;&#x27;</span>);</span></span><br><span class="line">+--------------------+----------------------+</span><br><span class="line">| JSON_QUOTE(&#x27;null&#x27;) | JSON_QUOTE(&#x27;&quot;null&quot;&#x27;) |</span><br><span class="line">+--------------------+----------------------+</span><br><span class="line">| &quot;null&quot;             | &quot;\&quot;null\&quot;&quot;           |</span><br><span class="line">+--------------------+----------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_QUOTE(<span class="string">&#x27;[1, 2, 3]&#x27;</span>);</span></span><br><span class="line">+-------------------------+</span><br><span class="line">| JSON_QUOTE(&#x27;[1, 2, 3]&#x27;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">| &quot;[1, 2, 3]&quot;             |</span><br><span class="line">+-------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="搜索JSON函数"><a href="#搜索JSON函数" class="headerlink" title="搜索JSON函数"></a>搜索JSON函数</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json-search-functions.html">Functions That Search JSON Values</a></p>
<h4 id="JSON-CONTAINS-target-candidate-path"><a href="#JSON-CONTAINS-target-candidate-path" class="headerlink" title="JSON_CONTAINS(target, candidate[, path])"></a>JSON_CONTAINS(target, candidate[, path])</h4><p>判断目标JSON是否包含候选内容，返回 0、1。target和candidate非有效json或者path为非有效路径表达式或者包含*字符。<br>如果要判断path是否存在数据，可以使用 <code>JSON_CONTAINS_PATH()</code>函数。</p>
<p>是否包含的判定规则如下</p>
<ol>
<li>判断是否包含是通过路径的值是否相等来实现的，值是否相等前提 <code>JSON_TYPE()</code> 必须相等（INTEGER 和 DECIMAL类型判断是例外，两种类型可以判断为相等）</li>
<li>如果target 和 candidate 都是array类型的时候，target必须完全包含candidate</li>
<li>candidate 是非 array 的时候，target中必须含有 candidate </li>
<li>candidate 是JSON Object的时候，target 中必须需包含 candidate 中相同的key与value</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: 2, &quot;c&quot;: &#123;&quot;d&quot;: 4&#125;&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j2 = <span class="string">&#x27;1&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS(@j, @j2, <span class="string">&#x27;$.a&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_CONTAINS(@j, @j2, &#x27;$.a&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                             1 |</span><br><span class="line">+-------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS(@j, @j2, <span class="string">&#x27;$.b&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_CONTAINS(@j, @j2, &#x27;$.b&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                             0 |</span><br><span class="line">+-------------------------------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j2 = <span class="string">&#x27;&#123;&quot;d&quot;: 4&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS(@j, @j2, <span class="string">&#x27;$.a&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_CONTAINS(@j, @j2, &#x27;$.a&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                             0 |</span><br><span class="line">+-------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS(@j, @j2, <span class="string">&#x27;$.c&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_CONTAINS(@j, @j2, &#x27;$.c&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                             1 |</span><br><span class="line">+-------------------------------+</span><br></pre></td></tr></table></figure>

<p>ps. 这里场景说明一下， 当(任务、工单)处理人是多个的时候，可以使用json array 类型存储处理人，且查询的时候使用:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from ticket where json_contains(operate_user,JSON_QUOTE(&#x27;userId&#x27;),&#x27;$&#x27;) = 1;</span><br></pre></td></tr></table></figure>
<p>注意字符串类型的userId需要是用 JSON_QUOTE 处理一下，或者直接加上双引号 <code>&quot;userId&quot;</code> 。</p>
<p>如果userId是数值类型可以省略双引号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select json_contains(JSON_ARRAY(111,222,333,444),&#x27;444&#x27;,&#x27;$&#x27;) as ret</span><br></pre></td></tr></table></figure>

<h4 id="JSON-CONTAINS-PATH-json-doc-one-or-all-path-path-…"><a href="#JSON-CONTAINS-PATH-json-doc-one-or-all-path-path-…" class="headerlink" title="JSON_CONTAINS_PATH(json_doc, one_or_all, path[, path] …)"></a>JSON_CONTAINS_PATH(json_doc, one_or_all, path[, path] …)</h4><p>判断JSON指定路径（支持多个）是否有值，返回 0、1. <code>one_or_all</code> 参数可选值只包含 <code>one</code>&#x2F;<code>all</code> </p>
<ul>
<li>one 只要有一个path存在的情况下返回1，否则返回0</li>
<li>all 所有path都存在的情况下返回1，否则返回0<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: 2, &quot;c&quot;: &#123;&quot;d&quot;: 4&#125;&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS_PATH(@j, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;$.a&#x27;</span>, <span class="string">&#x27;$.e&#x27;</span>);</span></span><br><span class="line">+---------------------------------------------+</span><br><span class="line">| JSON_CONTAINS_PATH(@j, &#x27;one&#x27;, &#x27;$.a&#x27;, &#x27;$.e&#x27;) |</span><br><span class="line">+---------------------------------------------+</span><br><span class="line">|                                           1 |</span><br><span class="line">+---------------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS_PATH(@j, <span class="string">&#x27;all&#x27;</span>, <span class="string">&#x27;$.a&#x27;</span>, <span class="string">&#x27;$.e&#x27;</span>);</span></span><br><span class="line">+---------------------------------------------+</span><br><span class="line">| JSON_CONTAINS_PATH(@j, &#x27;all&#x27;, &#x27;$.a&#x27;, &#x27;$.e&#x27;) |</span><br><span class="line">+---------------------------------------------+</span><br><span class="line">|                                           0 |</span><br><span class="line">+---------------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS_PATH(@j, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;$.c.d&#x27;</span>);</span></span><br><span class="line">+----------------------------------------+</span><br><span class="line">| JSON_CONTAINS_PATH(@j, &#x27;one&#x27;, &#x27;$.c.d&#x27;) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">|                                      1 |</span><br><span class="line">+----------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_CONTAINS_PATH(@j, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;$.a.d&#x27;</span>);</span></span><br><span class="line">+----------------------------------------+</span><br><span class="line">| JSON_CONTAINS_PATH(@j, &#x27;one&#x27;, &#x27;$.a.d&#x27;) |</span><br><span class="line">+----------------------------------------+</span><br><span class="line">|                                      0 |</span><br><span class="line">+----------------------------------------+</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="JSON-EXTRACT-json-doc-path-path-…"><a href="#JSON-EXTRACT-json-doc-path-path-…" class="headerlink" title="JSON_EXTRACT(json_doc, path[, path] …)"></a>JSON_EXTRACT(json_doc, path[, path] …)</h4><p>在JSON中按path提取数据，支持多path，如果有多个返回，自动按path顺序包装成 array 类型。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_EXTRACT(<span class="string">&#x27;[10, 20, [30, 40]]&#x27;</span>, <span class="string">&#x27;$[1]&#x27;</span>);</span></span><br><span class="line">+--------------------------------------------+</span><br><span class="line">| JSON_EXTRACT(&#x27;[10, 20, [30, 40]]&#x27;, &#x27;$[1]&#x27;) |</span><br><span class="line">+--------------------------------------------+</span><br><span class="line">| 20                                         |</span><br><span class="line">+--------------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_EXTRACT(<span class="string">&#x27;[10, 20, [30, 40]]&#x27;</span>, <span class="string">&#x27;$[1]&#x27;</span>, <span class="string">&#x27;$[0]&#x27;</span>);</span></span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| JSON_EXTRACT(&#x27;[10, 20, [30, 40]]&#x27;, &#x27;$[1]&#x27;, &#x27;$[0]&#x27;) |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| [20, 10]                                           |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_EXTRACT(<span class="string">&#x27;[10, 20, [30, 40]]&#x27;</span>, <span class="string">&#x27;$[2][*]&#x27;</span>);</span></span><br><span class="line">+-----------------------------------------------+</span><br><span class="line">| JSON_EXTRACT(&#x27;[10, 20, [30, 40]]&#x27;, &#x27;$[2][*]&#x27;) |</span><br><span class="line">+-----------------------------------------------+</span><br><span class="line">| [30, 40]                                      |</span><br><span class="line">+-----------------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="column-path"><a href="#column-path" class="headerlink" title="column-&gt;path"></a>column-&gt;path</h4><p>新增于<code>MySQL 5.7.9</code> 版本，作为 <code>JSON_EXTRACT</code>函数两个参数的简写形式。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT c, JSON_EXTRACT(c, <span class="string">&quot;$.id&quot;</span>), g</span></span><br><span class="line">     &gt; FROM jemp</span><br><span class="line">     &gt; WHERE JSON_EXTRACT(c, &quot;$.id&quot;) &gt; 1</span><br><span class="line">     &gt; ORDER BY JSON_EXTRACT(c, &quot;$.name&quot;);</span><br><span class="line">+-------------------------------+-----------+------+</span><br><span class="line">| c                             | c-&gt;&quot;$.id&quot; | g    |</span><br><span class="line">+-------------------------------+-----------+------+</span><br><span class="line">| &#123;&quot;id&quot;: &quot;3&quot;, &quot;name&quot;: &quot;Barney&quot;&#125; | &quot;3&quot;       |    3 |</span><br><span class="line">| &#123;&quot;id&quot;: &quot;4&quot;, &quot;name&quot;: &quot;Betty&quot;&#125;  | &quot;4&quot;       |    4 |</span><br><span class="line">| &#123;&quot;id&quot;: &quot;2&quot;, &quot;name&quot;: &quot;Wilma&quot;&#125;  | &quot;2&quot;       |    2 |</span><br><span class="line">+-------------------------------+-----------+------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT c, c-&gt;<span class="string">&quot;$.id&quot;</span>, g</span></span><br><span class="line">     &gt; FROM jemp</span><br><span class="line">     &gt; WHERE c-&gt;&quot;$.id&quot; &gt; 1</span><br><span class="line">     &gt; ORDER BY c-&gt;&quot;$.name&quot;;</span><br><span class="line">+-------------------------------+-----------+------+</span><br><span class="line">| c                             | c-&gt;&quot;$.id&quot; | g    |</span><br><span class="line">+-------------------------------+-----------+------+</span><br><span class="line">| &#123;&quot;id&quot;: &quot;3&quot;, &quot;name&quot;: &quot;Barney&quot;&#125; | &quot;3&quot;       |    3 |</span><br><span class="line">| &#123;&quot;id&quot;: &quot;4&quot;, &quot;name&quot;: &quot;Betty&quot;&#125;  | &quot;4&quot;       |    4 |</span><br><span class="line">| &#123;&quot;id&quot;: &quot;2&quot;, &quot;name&quot;: &quot;Wilma&quot;&#125;  | &quot;2&quot;       |    2 |</span><br><span class="line">+-------------------------------+-----------+------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">CREATE TABLE tj10 (a JSON, b INT);</span></span><br><span class="line">Query OK, 0 rows affected (0.26 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">INSERT INTO tj10</span></span><br><span class="line">     &gt; VALUES (&quot;[3,10,5,17,44]&quot;, 33), (&quot;[3,10,5,17,[22,44,66]]&quot;, 0);</span><br><span class="line">Query OK, 1 row affected (0.04 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT a-&gt;<span class="string">&quot;$[4]&quot;</span> FROM tj10;</span></span><br><span class="line">+--------------+</span><br><span class="line">| a-&gt;&quot;$[4]&quot;    |</span><br><span class="line">+--------------+</span><br><span class="line">| 44           |</span><br><span class="line">| [22, 44, 66] |</span><br><span class="line">+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT * FROM tj10 WHERE a-&gt;<span class="string">&quot;$[0]&quot;</span> = 3;</span></span><br><span class="line">+------------------------------+------+</span><br><span class="line">| a                            | b    |</span><br><span class="line">+------------------------------+------+</span><br><span class="line">| [3, 10, 5, 17, 44]           |   33 |</span><br><span class="line">| [3, 10, 5, 17, [22, 44, 66]] |    0 |</span><br><span class="line">+------------------------------+------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>不仅用于select语句中，也可以用在update&#x2F;delete语句中.</p>
<h4 id="column-path-1"><a href="#column-path-1" class="headerlink" title="column-&gt;&gt;path"></a>column-&gt;&gt;path</h4><p>新增于 MySQL 5.7.13 版本，在 <code>-&gt;</code> 基础上除去了引号。下面操作是等价的：</p>
<ul>
<li>JSON_UNQUOTE( JSON_EXTRACT(column, path) )</li>
<li>JSON_UNQUOTE(column -&gt; path)</li>
<li>column-&gt;&gt;path</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT c-&gt;<span class="string">&#x27;$.name&#x27;</span> AS name</span></span><br><span class="line">    -&gt;     FROM jemp WHERE g &gt; 2;</span><br><span class="line">+----------+</span><br><span class="line">| name     |</span><br><span class="line">+----------+</span><br><span class="line">| &quot;Barney&quot; |</span><br><span class="line">| &quot;Betty&quot;  |</span><br><span class="line">+----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_UNQUOTE(c-&gt;<span class="string">&#x27;$.name&#x27;</span>) AS name</span></span><br><span class="line">    -&gt;     FROM jemp WHERE g &gt; 2;</span><br><span class="line">+--------+</span><br><span class="line">| name   |</span><br><span class="line">+--------+</span><br><span class="line">| Barney |</span><br><span class="line">| Betty  |</span><br><span class="line">+--------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT c-&gt;&gt;<span class="string">&#x27;$.name&#x27;</span> AS name</span></span><br><span class="line">    -&gt;     FROM jemp WHERE g &gt; 2;</span><br><span class="line">+--------+</span><br><span class="line">| name   |</span><br><span class="line">+--------+</span><br><span class="line">| Barney |</span><br><span class="line">| Betty  |</span><br><span class="line">+--------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-KEYS-json-doc-path"><a href="#JSON-KEYS-json-doc-path" class="headerlink" title="JSON_KEYS(json_doc[, path])"></a>JSON_KEYS(json_doc[, path])</h4><p>返回第一层的所有的JSON key组合成的array 。如果指定 path ，按path 的第一层来。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_KEYS(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;</span>);</span></span><br><span class="line">+---------------------------------------+</span><br><span class="line">| JSON_KEYS(&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;) |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| [&quot;a&quot;, &quot;b&quot;]                            |</span><br><span class="line">+---------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_KEYS(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;</span>, <span class="string">&#x27;$.b&#x27;</span>);</span></span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| JSON_KEYS(&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;, &#x27;$.b&#x27;) |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| [&quot;c&quot;]                                        |</span><br><span class="line">+----------------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-SEARCH-json-doc-one-or-all-search-str-escape-char-path-…"><a href="#JSON-SEARCH-json-doc-one-or-all-search-str-escape-char-path-…" class="headerlink" title="JSON_SEARCH(json_doc, one_or_all, search_str[, escape_char[, path] …])"></a>JSON_SEARCH(json_doc, one_or_all, search_str[, escape_char[, path] …])</h4><p>返回指定JSON中包含目标值的path , one_or_all 参数解释如下</p>
<ul>
<li>one 找到第一个匹配的path后立即返回</li>
<li>all 搜索所有满足的path，自动包装成 array 类型</li>
</ul>
<p>search_str 支持 <code>%</code> 和 <code>_</code> 通配符，同 like 语句。默认的转移符是 <code>\</code> 可以通过 escape_char 指定（如果是null 也是 <code>\</code>）。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;[&quot;abc&quot;, [&#123;&quot;k&quot;: &quot;10&quot;&#125;, &quot;def&quot;], &#123;&quot;x&quot;:&quot;abc&quot;&#125;, &#123;&quot;y&quot;:&quot;bcd&quot;&#125;]&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_SEARCH(@j, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_SEARCH(@j, &#x27;one&#x27;, &#x27;abc&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">| &quot;$[0]&quot;                        |</span><br><span class="line">+-------------------------------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_SEARCH(@j, <span class="string">&#x27;all&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_SEARCH(@j, &#x27;all&#x27;, &#x27;abc&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">| [&quot;$[0]&quot;, &quot;$[2].x&quot;]            |</span><br><span class="line">+-------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="修改JSON函数"><a href="#修改JSON函数" class="headerlink" title="修改JSON函数"></a>修改JSON函数</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json-modification-functions.html">Functions That Modify JSON Values</a></p>
<h4 id="JSON-APPEND-json-doc-path-val-path-val-…"><a href="#JSON-APPEND-json-doc-path-val-path-val-…" class="headerlink" title="JSON_APPEND(json_doc, path, val[, path, val] …)"></a>JSON_APPEND(json_doc, path, val[, path, val] …)</h4><p>在JSON array追加一条记录，<code>MySQL 5.7.9</code> 版本后改名为 <code>JSON_ARRAY_APPEND()</code> ，<code>MySQL 8.0</code> 版本删除。</p>
<h4 id="JSON-ARRAY-APPEND-json-doc-path-val-path-val-…"><a href="#JSON-ARRAY-APPEND-json-doc-path-val-path-val-…" class="headerlink" title="JSON_ARRAY_APPEND(json_doc, path, val[, path, val] …)"></a>JSON_ARRAY_APPEND(json_doc, path, val[, path, val] …)</h4><p>在JSON array中指定path末尾追加一条记录，返回追加后的JSON 。非array的时候会自动组成 array。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;[&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY_APPEND(@j, <span class="string">&#x27;$[1]&#x27;</span>, 1);</span></span><br><span class="line">+----------------------------------+</span><br><span class="line">| JSON_ARRAY_APPEND(@j, &#x27;$[1]&#x27;, 1) |</span><br><span class="line">+----------------------------------+</span><br><span class="line">| [&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;, 1], &quot;d&quot;]        |</span><br><span class="line">+----------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123;&quot;a&quot;: 1&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY_APPEND(@j, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;z&#x27;</span>);</span></span><br><span class="line">+---------------------------------+</span><br><span class="line">| JSON_ARRAY_APPEND(@j, &#x27;$&#x27;, &#x27;z&#x27;) |</span><br><span class="line">+---------------------------------+</span><br><span class="line">| [&#123;&quot;a&quot;: 1&#125;, &quot;z&quot;]                 |</span><br><span class="line">+---------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-ARRAY-INSERT-json-doc-path-val-path-val-…"><a href="#JSON-ARRAY-INSERT-json-doc-path-val-path-val-…" class="headerlink" title="JSON_ARRAY_INSERT(json_doc, path, val[, path, val] …)"></a>JSON_ARRAY_INSERT(json_doc, path, val[, path, val] …)</h4><p>在指定path插入一条记录，返回修改后的JSON</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;[&quot;a&quot;, &#123;&quot;b&quot;: [1, 2]&#125;, [3, 4]]&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY_INSERT(@j, <span class="string">&#x27;$[1]&#x27;</span>, <span class="string">&#x27;x&#x27;</span>);</span></span><br><span class="line">+------------------------------------+</span><br><span class="line">| JSON_ARRAY_INSERT(@j, &#x27;$[1]&#x27;, &#x27;x&#x27;) |</span><br><span class="line">+------------------------------------+</span><br><span class="line">| [&quot;a&quot;, &quot;x&quot;, &#123;&quot;b&quot;: [1, 2]&#125;, [3, 4]]  |</span><br><span class="line">+------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY_INSERT(@j, <span class="string">&#x27;$[100]&#x27;</span>, <span class="string">&#x27;x&#x27;</span>);</span></span><br><span class="line">+--------------------------------------+</span><br><span class="line">| JSON_ARRAY_INSERT(@j, &#x27;$[100]&#x27;, &#x27;x&#x27;) |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">| [&quot;a&quot;, &#123;&quot;b&quot;: [1, 2]&#125;, [3, 4], &quot;x&quot;]    |</span><br><span class="line">+--------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_ARRAY_INSERT(@j, <span class="string">&#x27;$[2][1]&#x27;</span>, <span class="string">&#x27;y&#x27;</span>);</span></span><br><span class="line">+---------------------------------------+</span><br><span class="line">| JSON_ARRAY_INSERT(@j, &#x27;$[2][1]&#x27;, &#x27;y&#x27;) |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| [&quot;a&quot;, &#123;&quot;b&quot;: [1, 2]&#125;, [3, &quot;y&quot;, 4]]     |</span><br><span class="line">+---------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-INSERT-json-doc-path-val-path-val-…"><a href="#JSON-INSERT-json-doc-path-val-path-val-…" class="headerlink" title="JSON_INSERT(json_doc, path, val[, path, val] …)"></a>JSON_INSERT(json_doc, path, val[, path, val] …)</h4><p>JSON中插入数据，如果path已经存在则忽略，<strong>不会更新值</strong>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123; &quot;a&quot;: 1, &quot;b&quot;: [2, 3]&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_INSERT(@j, <span class="string">&#x27;$.a&#x27;</span>, 10, <span class="string">&#x27;$.c&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| JSON_INSERT(@j, &#x27;$.a&#x27;, 10, &#x27;$.c&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| &#123;&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;&#125;        |</span><br><span class="line">+----------------------------------------------------+</span><br></pre></td></tr></table></figure>
<p>注意上面的例子如果需要插入JSON array, 必须做转移。否则就是字面量。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_INSERT(@j, <span class="string">&#x27;$.a&#x27;</span>, 10, <span class="string">&#x27;$.c&#x27;</span>, CAST(<span class="string">&#x27;[true, false]&#x27;</span> AS JSON));</span></span><br><span class="line">+------------------------------------------------------------------+</span><br><span class="line">| JSON_INSERT(@j, &#x27;$.a&#x27;, 10, &#x27;$.c&#x27;, CAST(&#x27;[true, false]&#x27; AS JSON)) |</span><br><span class="line">+------------------------------------------------------------------+</span><br><span class="line">| &#123;&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: [true, false]&#125;                        |</span><br><span class="line">+------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h4 id="JSON-MERGE-json-doc-json-doc-json-doc-…"><a href="#JSON-MERGE-json-doc-json-doc-json-doc-…" class="headerlink" title="JSON_MERGE(json_doc, json_doc[, json_doc] …)"></a>JSON_MERGE(json_doc, json_doc[, json_doc] …)</h4><p>合并两个或者更多的JSON。<code>JSON_MERGE_PRESERVE()</code> 同义，在 <code>MySQL 5.7.22</code> 中弃用，<strong>并会在未来版本中删除</strong>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_MERGE(<span class="string">&#x27;[1, 2]&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+---------------------------------------+</span><br><span class="line">| JSON_MERGE(&#x27;[1, 2]&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| [1, 2, true, false]                   |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SHOW WARNINGS\G</span></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">  Level: Warning</span><br><span class="line">   Code: 1287</span><br><span class="line">Message: &#x27;JSON_MERGE&#x27; is deprecated and will be removed in a future release. \</span><br><span class="line"> Please use JSON_MERGE_PRESERVE/JSON_MERGE_PATCH instead</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h4 id="JSON-MERGE-PATCH-json-doc-json-doc-json-doc-…"><a href="#JSON-MERGE-PATCH-json-doc-json-doc-json-doc-…" class="headerlink" title="JSON_MERGE_PATCH(json_doc, json_doc[, json_doc] …)"></a>JSON_MERGE_PATCH(json_doc, json_doc[, json_doc] …)</h4><p>执行的逻辑同 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7396">RFC 7396</a> 定义，返回合并后的结果JSON 。<br>这里不详细讲解了，不常用，且逻辑复杂，容易出错，使用这个函数一定要理解其中的含义 。</p>
<h4 id="JSON-MERGE-PRESERVE-json-doc-json-doc-json-doc-…"><a href="#JSON-MERGE-PRESERVE-json-doc-json-doc-json-doc-…" class="headerlink" title="JSON_MERGE_PRESERVE(json_doc, json_doc[, json_doc] …)"></a>JSON_MERGE_PRESERVE(json_doc, json_doc[, json_doc] …)</h4><p>合并两个JSON 返回合并后的新JSON ， 合并规则如下</p>
<ul>
<li>多个 array 则合并成一个 array</li>
<li>多个 object 则合并成一个 object</li>
<li>单个标量则自动包装成array 然后按照 array的逻辑合并</li>
<li>array 和 object 则把 object 转成 array 按 array逻辑合并</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_MERGE_PRESERVE(<span class="string">&#x27;[1, 2]&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+------------------------------------------------+</span><br><span class="line">| JSON_MERGE_PRESERVE(&#x27;[1, 2]&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+------------------------------------------------+</span><br><span class="line">| [1, 2, true, false]                            |</span><br><span class="line">+------------------------------------------------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_MERGE_PRESERVE(<span class="string">&#x27;&#123;&quot;name&quot;: &quot;x&quot;&#125;&#x27;</span>, <span class="string">&#x27;&#123;&quot;id&quot;: 47&#125;&#x27;</span>);</span></span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| JSON_MERGE_PRESERVE(&#x27;&#123;&quot;name&quot;: &quot;x&quot;&#125;&#x27;, &#x27;&#123;&quot;id&quot;: 47&#125;&#x27;) |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| &#123;&quot;id&quot;: 47, &quot;name&quot;: &quot;x&quot;&#125;                            |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_MERGE_PRESERVE(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;true&#x27;</span>);</span></span><br><span class="line">+----------------------------------+</span><br><span class="line">| JSON_MERGE_PRESERVE(&#x27;1&#x27;, &#x27;true&#x27;) |</span><br><span class="line">+----------------------------------+</span><br><span class="line">| [1, true]                        |</span><br><span class="line">+----------------------------------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_MERGE_PRESERVE(<span class="string">&#x27;[1, 2]&#x27;</span>, <span class="string">&#x27;&#123;&quot;id&quot;: 47&#125;&#x27;</span>);</span></span><br><span class="line">+---------------------------------------------+</span><br><span class="line">| JSON_MERGE_PRESERVE(&#x27;[1, 2]&#x27;, &#x27;&#123;&quot;id&quot;: 47&#125;&#x27;) |</span><br><span class="line">+---------------------------------------------+</span><br><span class="line">| [1, 2, &#123;&quot;id&quot;: 47&#125;]                          |</span><br><span class="line">+---------------------------------------------+</span><br></pre></td></tr></table></figure>
<p>此函数在 <code>MySQL 5.7.22</code>版本加入，之前是使用的同义函数 <code>JSON_MERGE()</code>.</p>
<h4 id="JSON-REMOVE-json-doc-path-path-…"><a href="#JSON-REMOVE-json-doc-path-path-…" class="headerlink" title="JSON_REMOVE(json_doc, path[, path] …)"></a>JSON_REMOVE(json_doc, path[, path] …)</h4><p>删除指定的JSON数据返回删除后的JSON。多个path从左向右依次执行。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;[&quot;a&quot;, [&quot;b&quot;, &quot;c&quot;], &quot;d&quot;]&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_REMOVE(@j, <span class="string">&#x27;$[1]&#x27;</span>);</span></span><br><span class="line">+-------------------------+</span><br><span class="line">| JSON_REMOVE(@j, &#x27;$[1]&#x27;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">| [&quot;a&quot;, &quot;d&quot;]              |</span><br><span class="line">+-------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-REPLACE-json-doc-path-val-path-val-…"><a href="#JSON-REPLACE-json-doc-path-val-path-val-…" class="headerlink" title="JSON_REPLACE(json_doc, path, val[, path, val] …)"></a>JSON_REPLACE(json_doc, path, val[, path, val] …)</h4><p>替换指定的JSON值，返回替换后的新JSON，如果path不存在则忽略。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123; &quot;a&quot;: 1, &quot;b&quot;: [2, 3]&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_REPLACE(@j, <span class="string">&#x27;$.a&#x27;</span>, 10, <span class="string">&#x27;$.c&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">| JSON_REPLACE(@j, &#x27;$.a&#x27;, 10, &#x27;$.c&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">| &#123;&quot;a&quot;: 10, &quot;b&quot;: [2, 3]&#125;                              |</span><br><span class="line">+-----------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-SET-json-doc-path-val-path-val-…"><a href="#JSON-SET-json-doc-path-val-path-val-…" class="headerlink" title="JSON_SET(json_doc, path, val[, path, val] …)"></a>JSON_SET(json_doc, path, val[, path, val] …)</h4><p>插入或者更新指定path的JSON的值，并返回操作后的新JSON 。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123; &quot;a&quot;: 1, &quot;b&quot;: [2, 3]&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_SET(@j, <span class="string">&#x27;$.a&#x27;</span>, 10, <span class="string">&#x27;$.c&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| JSON_SET(@j, &#x27;$.a&#x27;, 10, &#x27;$.c&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line">| &#123;&quot;a&quot;: 10, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;&#125;    |</span><br><span class="line">+-------------------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_INSERT(@j, <span class="string">&#x27;$.a&#x27;</span>, 10, <span class="string">&#x27;$.c&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| JSON_INSERT(@j, &#x27;$.a&#x27;, 10, &#x27;$.c&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line">| &#123;&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;&#125;        |</span><br><span class="line">+----------------------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_REPLACE(@j, <span class="string">&#x27;$.a&#x27;</span>, 10, <span class="string">&#x27;$.c&#x27;</span>, <span class="string">&#x27;[true, false]&#x27;</span>);</span></span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">| JSON_REPLACE(@j, &#x27;$.a&#x27;, 10, &#x27;$.c&#x27;, &#x27;[true, false]&#x27;) |</span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">| &#123;&quot;a&quot;: 10, &quot;b&quot;: [2, 3]&#125;                              |</span><br><span class="line">+-----------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p><code>JSON_SET()</code>, <code>JSON_INSERT()</code>, <code>JSON_REPLACE()</code> 这三个函数的区别:</p>
<ul>
<li>JSON_SET() 存在则替换，不存在则添加</li>
<li>JSON_INSERT() 只新增，存在则忽略</li>
<li>JSON_REPLACE() 值替换，不存在则忽略</li>
</ul>
<h4 id="JSON-UNQUOTE-json-val"><a href="#JSON-UNQUOTE-json-val" class="headerlink" title="JSON_UNQUOTE(json_val)"></a>JSON_UNQUOTE(json_val)</h4><p>去除引号并返回JSON值的 <code>utf8mb4</code> 编码的String .</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&quot;abc&quot;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT @j, JSON_UNQUOTE(@j);</span></span><br><span class="line">+-------+------------------+</span><br><span class="line">| @j    | JSON_UNQUOTE(@j) |</span><br><span class="line">+-------+------------------+</span><br><span class="line">| &quot;abc&quot; | abc              |</span><br><span class="line">+-------+------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;[1, 2, 3]&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT @j, JSON_UNQUOTE(@j);</span></span><br><span class="line">+-----------+------------------+</span><br><span class="line">| @j        | JSON_UNQUOTE(@j) |</span><br><span class="line">+-----------+------------------+</span><br><span class="line">| [1, 2, 3] | [1, 2, 3]        |</span><br><span class="line">+-----------+------------------+</span><br></pre></td></tr></table></figure>

<h3 id="JSON属性函数"><a href="#JSON属性函数" class="headerlink" title="JSON属性函数"></a>JSON属性函数</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json-attribute-functions.html">Functions That Return JSON Value Attributes</a></p>
<h4 id="JSON-DEPTH-json-doc"><a href="#JSON-DEPTH-json-doc" class="headerlink" title="JSON_DEPTH(json_doc)"></a>JSON_DEPTH(json_doc)</h4><p>返回JSON的最大深度。所有的空 array和空object或者标量值最大深度都是1</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_DEPTH(<span class="string">&#x27;&#123;&#125;&#x27;</span>), JSON_DEPTH(<span class="string">&#x27;[]&#x27;</span>), JSON_DEPTH(<span class="string">&#x27;true&#x27;</span>);</span></span><br><span class="line">+------------------+------------------+--------------------+</span><br><span class="line">| JSON_DEPTH(&#x27;&#123;&#125;&#x27;) | JSON_DEPTH(&#x27;[]&#x27;) | JSON_DEPTH(&#x27;true&#x27;) |</span><br><span class="line">+------------------+------------------+--------------------+</span><br><span class="line">|                1 |                1 |                  1 |</span><br><span class="line">+------------------+------------------+--------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_DEPTH(<span class="string">&#x27;[10, 20]&#x27;</span>), JSON_DEPTH(<span class="string">&#x27;[[], &#123;&#125;]&#x27;</span>);</span></span><br><span class="line">+------------------------+------------------------+</span><br><span class="line">| JSON_DEPTH(&#x27;[10, 20]&#x27;) | JSON_DEPTH(&#x27;[[], &#123;&#125;]&#x27;) |</span><br><span class="line">+------------------------+------------------------+</span><br><span class="line">|                      2 |                      2 |</span><br><span class="line">+------------------------+------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_DEPTH(<span class="string">&#x27;[10, &#123;&quot;a&quot;: 20&#125;]&#x27;</span>);</span></span><br><span class="line">+-------------------------------+</span><br><span class="line">| JSON_DEPTH(&#x27;[10, &#123;&quot;a&quot;: 20&#125;]&#x27;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                             3 |</span><br><span class="line">+-------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-LENGTH-json-doc-path"><a href="#JSON-LENGTH-json-doc-path" class="headerlink" title="JSON_LENGTH(json_doc[, path])"></a>JSON_LENGTH(json_doc[, path])</h4><p>返回JSON最大长度，如果指定了 path按path对应的JSON来计算。长度规则如下</p>
<ul>
<li>标量值长度都是1</li>
<li>array类型返回其对应包含的元素个数</li>
<li>object类型返回其包含的key个数</li>
<li>不计算嵌套array或者object</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_LENGTH(<span class="string">&#x27;[1, 2, &#123;&quot;a&quot;: 3&#125;]&#x27;</span>);</span></span><br><span class="line">+---------------------------------+</span><br><span class="line">| JSON_LENGTH(&#x27;[1, 2, &#123;&quot;a&quot;: 3&#125;]&#x27;) |</span><br><span class="line">+---------------------------------+</span><br><span class="line">|                               3 |</span><br><span class="line">+---------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_LENGTH(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;</span>);</span></span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| JSON_LENGTH(&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;) |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">|                                       2 |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_LENGTH(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;</span>, <span class="string">&#x27;$.b&#x27;</span>);</span></span><br><span class="line">+------------------------------------------------+</span><br><span class="line">| JSON_LENGTH(&#x27;&#123;&quot;a&quot;: 1, &quot;b&quot;: &#123;&quot;c&quot;: 30&#125;&#125;&#x27;, &#x27;$.b&#x27;) |</span><br><span class="line">+------------------------------------------------+</span><br><span class="line">|                                              1 |</span><br><span class="line">+------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="JSON-TYPE-json-val"><a href="#JSON-TYPE-json-val" class="headerlink" title="JSON_TYPE(json_val)"></a>JSON_TYPE(json_val)</h4><p>返回JSON值的JSON类型，使用 <code>utf8mb4</code>字符串表示。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SET @j = <span class="string">&#x27;&#123;&quot;a&quot;: [10, true]&#125;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_TYPE(@j);</span></span><br><span class="line">+---------------+</span><br><span class="line">| JSON_TYPE(@j) |</span><br><span class="line">+---------------+</span><br><span class="line">| OBJECT        |</span><br><span class="line">+---------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_TYPE(JSON_EXTRACT(@j, <span class="string">&#x27;$.a&#x27;</span>));</span></span><br><span class="line">+------------------------------------+</span><br><span class="line">| JSON_TYPE(JSON_EXTRACT(@j, &#x27;$.a&#x27;)) |</span><br><span class="line">+------------------------------------+</span><br><span class="line">| ARRAY                              |</span><br><span class="line">+------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_TYPE(JSON_EXTRACT(@j, <span class="string">&#x27;$.a[0]&#x27;</span>));</span></span><br><span class="line">+---------------------------------------+</span><br><span class="line">| JSON_TYPE(JSON_EXTRACT(@j, &#x27;$.a[0]&#x27;)) |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| INTEGER                               |</span><br><span class="line">+---------------------------------------+</span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT JSON_TYPE(JSON_EXTRACT(@j, <span class="string">&#x27;$.a[1]&#x27;</span>));</span></span><br><span class="line">+---------------------------------------+</span><br><span class="line">| JSON_TYPE(JSON_EXTRACT(@j, &#x27;$.a[1]&#x27;)) |</span><br><span class="line">+---------------------------------------+</span><br><span class="line">| BOOLEAN                               |</span><br><span class="line">+---------------------------------------+</span><br></pre></td></tr></table></figure>
<p>返回的类型包含</p>
<ul>
<li>JSON 类型:<ul>
<li>OBJECT: JSON objects</li>
<li>ARRAY: JSON arrays</li>
<li>BOOLEAN: The JSON true and false literals</li>
<li>NULL: The JSON null literal</li>
</ul>
</li>
<li>Numeric 类型:<ul>
<li>INTEGER: MySQL TINYINT, SMALLINT, MEDIUMINT and INT and BIGINT scalars</li>
<li>DOUBLE: MySQL DOUBLE FLOAT scalars</li>
<li>DECIMAL: MySQL DECIMAL and NUMERIC scalars</li>
</ul>
</li>
<li>Temporal 类型:<ul>
<li>DATETIME: MySQL DATETIME and TIMESTAMP scalars</li>
<li>DATE: MySQL DATE scalars</li>
<li>TIME: MySQL TIME scalars</li>
</ul>
</li>
<li>String 类型:<ul>
<li>STRING: MySQL utf8 character type scalars: CHAR, VARCHAR, TEXT, ENUM, and SET</li>
</ul>
</li>
<li>Binary 类型:<ul>
<li>BLOB: MySQL binary type scalars: BINARY, VARBINARY, BLOB</li>
<li>BIT: MySQL BIT scalars</li>
</ul>
</li>
<li>其他类型:<ul>
<li>OPAQUE (raw bits)</li>
</ul>
</li>
</ul>
<h4 id="JSON-VALID-val"><a href="#JSON-VALID-val" class="headerlink" title="JSON_VALID(val)"></a>JSON_VALID(val)</h4><p>判断是否为有效的 JSON ，返回 0、1</p>
<h3 id="JSON工具函数"><a href="#JSON工具函数" class="headerlink" title="JSON工具函数"></a>JSON工具函数</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json-utility-functions.html">JSON Utility Functions</a></p>
<h4 id="JSON-PRETTY-json-val"><a href="#JSON-PRETTY-json-val" class="headerlink" title="JSON_PRETTY(json_val)"></a>JSON_PRETTY(json_val)</h4><p>返回一个格式化后易于阅读的JSON 串，MySQL 5.7.22 及以后版本可用。</p>
<h4 id="JSON-STORAGE-SIZE-json-val"><a href="#JSON-STORAGE-SIZE-json-val" class="headerlink" title="JSON_STORAGE_SIZE(json_val)"></a>JSON_STORAGE_SIZE(json_val)</h4><p>返回JSON存储的字节（bytes）数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">CREATE TABLE jtable (jcol JSON);</span></span><br><span class="line">Query OK, 0 rows affected (0.42 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">INSERT INTO jtable VALUES</span></span><br><span class="line">    -&gt;     (&#x27;&#123;&quot;a&quot;: 1000, &quot;b&quot;: &quot;wxyz&quot;, &quot;c&quot;: &quot;[1, 3, 5, 7]&quot;&#125;&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.04 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT</span></span><br><span class="line">    -&gt;     jcol,</span><br><span class="line">    -&gt;     JSON_STORAGE_SIZE(jcol) AS Size</span><br><span class="line">    -&gt; FROM jtable;</span><br><span class="line">+-----------------------------------------------+------+</span><br><span class="line">| jcol                                          | Size |</span><br><span class="line">+-----------------------------------------------+------+</span><br><span class="line">| &#123;&quot;a&quot;: 1000, &quot;b&quot;: &quot;wxyz&quot;, &quot;c&quot;: &quot;[1, 3, 5, 7]&quot;&#125; |   47 |</span><br><span class="line">+-----------------------------------------------+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>


<h2 id="JSON-Index"><a href="#JSON-Index" class="headerlink" title="JSON Index"></a>JSON Index</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/create-table-secondary-indexes.html#json-column-indirect-index">JSON 类型的列不能直接创建索引</a>，但是可以利用虚拟字段间接建立索引。<br>创建一个虚拟字段，代表JSON中的某一个属性，然后在这个列上建立索引即可：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">CREATE TABLE jemp (</span></span><br><span class="line">    -&gt;     c JSON,</span><br><span class="line">    -&gt;     g INT GENERATED ALWAYS AS (c-&gt;&quot;$.id&quot;),</span><br><span class="line">    -&gt;     INDEX i (g)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.28 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">INSERT INTO jemp (c) VALUES</span></span><br><span class="line">     &gt;   (&#x27;&#123;&quot;id&quot;: &quot;1&quot;, &quot;name&quot;: &quot;Fred&quot;&#125;&#x27;), (&#x27;&#123;&quot;id&quot;: &quot;2&quot;, &quot;name&quot;: &quot;Wilma&quot;&#125;&#x27;),</span><br><span class="line">     &gt;   (&#x27;&#123;&quot;id&quot;: &quot;3&quot;, &quot;name&quot;: &quot;Barney&quot;&#125;&#x27;), (&#x27;&#123;&quot;id&quot;: &quot;4&quot;, &quot;name&quot;: &quot;Betty&quot;&#125;&#x27;);</span><br><span class="line">Query OK, 4 rows affected (0.04 sec)</span><br><span class="line">Records: 4  Duplicates: 0  Warnings: 0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SELECT c-&gt;&gt;<span class="string">&quot;$.name&quot;</span> AS name</span></span><br><span class="line">     &gt;     FROM jemp WHERE g &gt; 2;</span><br><span class="line">+--------+</span><br><span class="line">| name   |</span><br><span class="line">+--------+</span><br><span class="line">| Barney |</span><br><span class="line">| Betty  |</span><br><span class="line">+--------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">EXPLAIN SELECT c-&gt;&gt;<span class="string">&quot;$.name&quot;</span> AS name</span></span><br><span class="line">     &gt;    FROM jemp WHERE g &gt; 2\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">           id: 1</span><br><span class="line">  select_type: SIMPLE</span><br><span class="line">        table: jemp</span><br><span class="line">   partitions: NULL</span><br><span class="line">         type: range</span><br><span class="line">possible_keys: i</span><br><span class="line">          key: i</span><br><span class="line">      key_len: 5</span><br><span class="line">          ref: NULL</span><br><span class="line">         rows: 2</span><br><span class="line">     filtered: 100.00</span><br><span class="line">        Extra: Using where</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">SHOW WARNINGS\G</span></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">  Level: Note</span><br><span class="line">   Code: 1003</span><br><span class="line">Message: /* select#1 */ select json_unquote(json_extract(`test`.`jemp`.`c`,&#x27;$.name&#x27;))</span><br><span class="line">AS `name` from `test`.`jemp` where (`test`.`jemp`.`g` &gt; 2)</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>


<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/json-functions.html">5.7 json-functions</a></p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/json-functions.html">8.0 json-functions</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/database/" rel="tag"># database</a>
              <a href="/tags/mysql/" rel="tag"># mysql</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/03/30/java/20230331-LambdaMetafactory/" rel="prev" title="LambdaMetafactory 类详解">
      <i class="fa fa-chevron-left"></i> LambdaMetafactory 类详解
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/05/08/db/20230508-how-mysql-execute/" rel="next" title="一条SQL是如何在mysql执行的">
      一条SQL是如何在mysql执行的 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#JSON-Data-Type"><span class="nav-number">1.</span> <span class="nav-text">JSON Data Type</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSON-Functions"><span class="nav-number">2.</span> <span class="nav-text">JSON Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAJSON%E5%87%BD%E6%95%B0"><span class="nav-number">2.1.</span> <span class="nav-text">创建JSON函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-ARRAY-val-val-%E2%80%A6"><span class="nav-number">2.1.1.</span> <span class="nav-text">JSON_ARRAY([val[, val] …])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-OBJECT-key-val-key-val-%E2%80%A6"><span class="nav-number">2.1.2.</span> <span class="nav-text">JSON_OBJECT([key, val[, key, val] …])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-QUOTE-string"><span class="nav-number">2.1.3.</span> <span class="nav-text">JSON_QUOTE(string)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2JSON%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.</span> <span class="nav-text">搜索JSON函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-CONTAINS-target-candidate-path"><span class="nav-number">2.2.1.</span> <span class="nav-text">JSON_CONTAINS(target, candidate[, path])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-CONTAINS-PATH-json-doc-one-or-all-path-path-%E2%80%A6"><span class="nav-number">2.2.2.</span> <span class="nav-text">JSON_CONTAINS_PATH(json_doc, one_or_all, path[, path] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-EXTRACT-json-doc-path-path-%E2%80%A6"><span class="nav-number">2.2.3.</span> <span class="nav-text">JSON_EXTRACT(json_doc, path[, path] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#column-path"><span class="nav-number">2.2.4.</span> <span class="nav-text">column-&gt;path</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#column-path-1"><span class="nav-number">2.2.5.</span> <span class="nav-text">column-&gt;&gt;path</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-KEYS-json-doc-path"><span class="nav-number">2.2.6.</span> <span class="nav-text">JSON_KEYS(json_doc[, path])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-SEARCH-json-doc-one-or-all-search-str-escape-char-path-%E2%80%A6"><span class="nav-number">2.2.7.</span> <span class="nav-text">JSON_SEARCH(json_doc, one_or_all, search_str[, escape_char[, path] …])</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9JSON%E5%87%BD%E6%95%B0"><span class="nav-number">2.3.</span> <span class="nav-text">修改JSON函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-APPEND-json-doc-path-val-path-val-%E2%80%A6"><span class="nav-number">2.3.1.</span> <span class="nav-text">JSON_APPEND(json_doc, path, val[, path, val] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-ARRAY-APPEND-json-doc-path-val-path-val-%E2%80%A6"><span class="nav-number">2.3.2.</span> <span class="nav-text">JSON_ARRAY_APPEND(json_doc, path, val[, path, val] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-ARRAY-INSERT-json-doc-path-val-path-val-%E2%80%A6"><span class="nav-number">2.3.3.</span> <span class="nav-text">JSON_ARRAY_INSERT(json_doc, path, val[, path, val] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-INSERT-json-doc-path-val-path-val-%E2%80%A6"><span class="nav-number">2.3.4.</span> <span class="nav-text">JSON_INSERT(json_doc, path, val[, path, val] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-MERGE-json-doc-json-doc-json-doc-%E2%80%A6"><span class="nav-number">2.3.5.</span> <span class="nav-text">JSON_MERGE(json_doc, json_doc[, json_doc] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-MERGE-PATCH-json-doc-json-doc-json-doc-%E2%80%A6"><span class="nav-number">2.3.6.</span> <span class="nav-text">JSON_MERGE_PATCH(json_doc, json_doc[, json_doc] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-MERGE-PRESERVE-json-doc-json-doc-json-doc-%E2%80%A6"><span class="nav-number">2.3.7.</span> <span class="nav-text">JSON_MERGE_PRESERVE(json_doc, json_doc[, json_doc] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-REMOVE-json-doc-path-path-%E2%80%A6"><span class="nav-number">2.3.8.</span> <span class="nav-text">JSON_REMOVE(json_doc, path[, path] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-REPLACE-json-doc-path-val-path-val-%E2%80%A6"><span class="nav-number">2.3.9.</span> <span class="nav-text">JSON_REPLACE(json_doc, path, val[, path, val] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-SET-json-doc-path-val-path-val-%E2%80%A6"><span class="nav-number">2.3.10.</span> <span class="nav-text">JSON_SET(json_doc, path, val[, path, val] …)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-UNQUOTE-json-val"><span class="nav-number">2.3.11.</span> <span class="nav-text">JSON_UNQUOTE(json_val)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSON%E5%B1%9E%E6%80%A7%E5%87%BD%E6%95%B0"><span class="nav-number">2.4.</span> <span class="nav-text">JSON属性函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-DEPTH-json-doc"><span class="nav-number">2.4.1.</span> <span class="nav-text">JSON_DEPTH(json_doc)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-LENGTH-json-doc-path"><span class="nav-number">2.4.2.</span> <span class="nav-text">JSON_LENGTH(json_doc[, path])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-TYPE-json-val"><span class="nav-number">2.4.3.</span> <span class="nav-text">JSON_TYPE(json_val)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-VALID-val"><span class="nav-number">2.4.4.</span> <span class="nav-text">JSON_VALID(val)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSON%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0"><span class="nav-number">2.5.</span> <span class="nav-text">JSON工具函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-PRETTY-json-val"><span class="nav-number">2.5.1.</span> <span class="nav-text">JSON_PRETTY(json_val)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-STORAGE-SIZE-json-val"><span class="nav-number">2.5.2.</span> <span class="nav-text">JSON_STORAGE_SIZE(json_val)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JSON-Index"><span class="nav-number">3.</span> <span class="nav-text">JSON Index</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">4.</span> <span class="nav-text">参考</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lianhui.klh"
      src="https://cbu01.alicdn.com/cms/upload/2016/600/239/2932006_509044107.jpg">
  <p class="site-author-name" itemprop="name">lianhui.klh</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">219</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">104</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lianhui.klh</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
